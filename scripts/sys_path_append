#!/usr/bin/env python3
"""
Add paths to the system PATH environment variable.
"""

import os
from argparse import ArgumentParser
from pathlib import Path


def main():
    parser = ArgumentParser(description="Add paths to system PATH")
    parser.add_argument("paths", nargs="+", help="Directories to add to PATH")
    parser.add_argument(
        "-p",
        "--prepend",
        action="store_true",
        help="Add to beginning of PATH instead of end",
    )
    args = parser.parse_args()

    # Get current PATH and split into list
    current_path = os.environ.get("PATH", "")
    path_separator = ";" if os.name == "nt" else ":"
    path_list = [p for p in current_path.split(path_separator) if p]

    # Process new paths
    for path_str in args.paths:
        # Resolve to absolute path and convert to string
        resolved_path = str(Path(path_str).resolve())

        # Skip if path doesn't exist
        if not Path(resolved_path).exists():
            continue

        # Add if not already in PATH
        if resolved_path not in path_list:
            if args.prepend:
                path_list.insert(0, resolved_path)
            else:
                path_list.append(resolved_path)

    # Print the new PATH
    print(path_separator.join(path_list))


if __name__ == "__main__":
    main()
